<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Rastreo de Env√≠os | Importa F√°cil</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      /* Ajusta este valor para subir/bajar todo el contenido */
      --top-space: 10px;      /* antes eran ~2rem; ahora mucho menos */
      --card-max: 560px;
      --brand: #2c3e50;
      --primary: #3498db;
      --primary-600: #2980b9;
      --muted: #f5f6fa;
      --result-bg: #eafaf0;
      --result-border: #2ecc71;
    }

    /* Layout base */
    html, body { height: 100%; }
    body{
      font-family: Segoe UI, Arial, system-ui, -apple-system, sans-serif;
      background: var(--muted);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: var(--top-space) 16px 24px;  /* <‚Äî menos padding arriba */
    }

    /* Logo centrado y m√°s cercano al borde superior */
    .logo{ max-width: 220px; margin: 6px auto 12px; display:block; }

    /* Tarjeta principal */
    .card{
      background:#fff;
      border-radius: 14px;
      padding: 22px;
      box-shadow: 0 10px 28px rgba(0,0,0,.08);
      width: 100%;
      max-width: var(--card-max);
      margin: 0 auto;              /* centrada horizontal */
    }

    h2{ margin: 0 0 14px; text-align:center; color: var(--brand); }

    /* Barra de b√∫squeda compacta */
    .search{
      display:flex; gap:10px; align-items:center;
      margin: 6px 0 12px;
    }
    .search input{
      flex:1;
      padding: .80rem .95rem;
      border:1px solid #d8dde6;
      border-radius:10px;
      font-size:1rem;
      outline:none;
      transition: box-shadow .2s, border-color .2s;
      background:#fff;
    }
    .search input:focus{
      border-color: #c5d7f5;
      box-shadow: 0 0 0 3px rgba(52,152,219,.15);
    }
    .search button{
      padding:.80rem 1.1rem;
      background: var(--primary);
      color:#fff; border:0; border-radius:10px;
      font-size:1rem; cursor:pointer;
      transition: background .2s, transform .05s;
      white-space: nowrap;
    }
    .search button:hover{ background: var(--primary-600); }
    .search button:active{ transform: translateY(1px); }

    /* Resultados */
    #res{
      margin-top: 10px;
      padding: 14px 16px;
      background:#ecf0f1;
      border-radius:10px;
      border-left:5px solid var(--primary);
      font-size:1rem;
      line-height:1.45;
    }
    /* Cuando hay match, √∫samos un verde suave */
    #res.ok{
      background: var(--result-bg);
      border-left-color: var(--result-border);
    }

    /* Responsive: en m√≥viles, los controles ocupan toda la fila */
    @media (max-width: 520px){
      .search{ flex-direction: column; align-items: stretch; }
      .search button{ width:100%; }
    }
  </style>
</head>
<body>
  <!-- Logo (base64, el tuyo actual) -->
  <img class="logo" alt="Importa F√°cil"
       src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjwAAAB/CAYAAADrXBhxAAAAAXNSR0IArs4c6QAAIABJREFUeF7t... (tu base64 aqu√≠, el mismo que ya usas) ..." />

  <div class="card">
    <h2>Rastreo de Env√≠os</h2>

    <div class="search">
      <input id="trk" placeholder="Ej: DEL12345" />
      <button onclick="buscar()">Buscar</button>
    </div>

    <div id="res"></div>
  </div>

  <script>
    // Tu URL /exec de Apps Script
    const API_URL = "https://script.google.com/macros/s/AKfycbyL54IEYlM-jJJiq50QQtf3dvHIihLWQT6BPUGdf709FiH3bsW-Pz1Mgr7myvFyU4kTIQ/exec";
    const $ = (q)=>document.querySelector(q);

    // Enter para disparar b√∫squeda
    document.addEventListener('DOMContentLoaded', () => {
      const inp = $('#trk');
      if (inp) inp.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') buscar();
      });
    });

    function buscar(){
      const t = $('#trk').value.trim().toUpperCase();
      const res = $('#res');
      if(!t){ show(res, '‚ö†Ô∏è Ingres√° un n√∫mero de tracking.'); return; }
      show(res, 'üîé Buscando...');

      // Limpia llamada anterior (si hubo)
      const old = document.getElementById('jsonp-call');
      if (old) old.remove();

      // Arma URL con callback JSONP
      const url = API_URL
        + '?tracking=' + encodeURIComponent(t)
        + '&ua=' + encodeURIComponent(navigator.userAgent || '')
        + '&ref=' + encodeURIComponent(document.referrer || location.origin || '')
        + '&callback=mostrar'
        + '&_=' + Date.now(); // evita cach√©

      // Inyecta <script> JSONP para evitar CORS
      const s = document.createElement('script');
      s.id = 'jsonp-call';
      s.src = url;
      s.onerror = () => { show(res, '‚ùå Error de conexi√≥n.'); };
      document.body.appendChild(s);
    }

    function show(node, html, ok=false){
      node.classList.toggle('ok', ok);
      node.innerHTML = html;
    }

    // Callback que Apps Script llamar√°: mostrar({ ok, found, results, notify })
    function mostrar(api){
      const d = $('#res');
      if (!api || !api.ok) {
        show(d, '‚ùå Error en la API.');
        return;
      }
      if (!api.results || !api.results.length) {
        show(d, '‚ùå Env√≠o no encontrado. Verific√° el n√∫mero.');
        return;
      }
      const x = api.results[0];
      const fechaTxt = x.fecha ? new Date(x.fecha).toLocaleString() : 'Sin fecha';
      show(d, `
        <p><strong>Tracking:</strong> ${x.tracking||''}</p>
        <p><strong># de almac√©n:</strong> ${x.almacen||''}</p>
        <p><strong>Peso:</strong> ${x.peso??''}</p>
        <p><strong>Estado:</strong> ${x.estado||''}</p>
        <p><strong>Ubicaci√≥n:</strong> ${x.ubicacion||''}</p>
        <p><strong>Fecha:</strong> ${fechaTxt}</p>
      `, true);
    }
  </script>
</body>
</html>

