<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Importa Fácil | Rastreador de Envíos (Mockup)</title>
  <style>
    :root{
      --bg: #0b1220;
      --card: #0f172aee;
      --muted: #94a3b8;
      --text: #e5e7eb;
      --primary: #22c55e;
      --primary-700:#16a34a;
      --accent: #60a5fa;
      --ring: #22c55e33;
      --danger: #ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;
      color:var(--text); background: radial-gradient(1200px 600px at 10% 0%, #0b1220, #0b1220 40%, #0a0f1a 60%, #070b12 100%);
      letter-spacing:.2px;
    }
    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    header{
      position:relative; overflow:hidden; border-radius:20px; margin: 12px 0 28px; padding: 26px 22px; background:linear-gradient(135deg,#0b1220,#0b1220 50%,#0f172a 100%);
      outline:1px solid #1f2937; box-shadow: inset 0 0 0 1px #0b1220, 0 10px 30px rgba(0,0,0,.35);
    }
    .brand{display:flex; gap:12px; align-items:center; justify-content:center; flex-direction:column; text-align:center}
    .brand-logo{
      width:48px; height:48px; display:grid; place-items:center; border-radius:14px;
      background: conic-gradient(from 180deg at 50% 50%, #16a34a, #22c55e, #60a5fa, #16a34a);
      box-shadow:0 6px 24px #22c55e44, inset 0 0 0 2px #0b1220;
    }
    .brand-logo svg{filter:drop-shadow(0 4px 10px #000)}
    .brand h1{font-size: clamp(1.1rem, 2vw, 1.4rem); margin:0}
    .brand p{margin:2px 0 0;color:var(--muted);font-size:.95rem}
    .badges{margin-top:10px; display:flex; gap:10px; flex-wrap:wrap}
    .badge{background:#0b1327; color:#a5b4fc; border:1px solid #1f2a44; padding:6px 10px; border-radius:999px; font-size:.82rem; display:inline-flex; gap:8px; align-items:center}

    .grid{display:grid; gap:18px; grid-template-columns:1fr}
    @media (max-width: 900px){ .grid{grid-template-columns: 1fr} }

    .card{background:var(--card); border:1px solid #1e293b; border-radius:18px; padding:22px; box-shadow: 0 10px 30px rgba(0,0,0,.25)}
    .card .title{margin:0 0 12px; font-size:1.05rem; color:#cbd5e1}
    .helper{margin-top:8px; color:var(--muted); font-size:.9rem}

    .field{
      position:relative; display:flex; gap:10px; align-items:center; margin:14px 0 8px
    }
    .input{
      flex:1; background:#0b1327; border:1px solid #1f2a44; color:#e5e7eb; border-radius:14px; height:48px; padding:0 44px 0 42px; font-size:1rem; outline:none; transition:border-color .2s, box-shadow .2s
    }
    .input:focus{border-color:#2dd4bf; box-shadow:0 0 0 6px var(--ring)}
    .input::placeholder{color:#64748b}
    .left-icon{position:absolute; left:12px; width:22px; height:22px; opacity:.7}

    .btn{
      background:linear-gradient(180deg, var(--primary), var(--primary-700));
      border:none; color:#071215; height:48px; padding:0 18px; border-radius:14px; font-weight:700; cursor:pointer; display:inline-flex; align-items:center; gap:10px; box-shadow: 0 8px 18px #22c55e44, inset 0 0 0 1px #eafff0; transition: transform .06s ease, filter .15s ease
    }
    .btn:active{transform:translateY(1px)}

    .btn-ghost{background:#0b1327; border:1px solid #1f2a44; color:#cbd5e1}

    .hstack{display:flex; gap:10px; align-items:center; flex-wrap:wrap}

    .divider{height:1px; background:linear-gradient(90deg, transparent, #1f2a44, transparent); margin: 16px 0}

    .pill-hint{font-size:.85rem; color:#a8b1ff; display:flex; align-items:center; gap:8px}

    .result-wrap{display:none}
    .result-wrap.active{display:block}

    table{border-collapse:separate; border-spacing:0; width:100%; font-size:.95rem}
    thead th{ text-align:left; color:#a5b4fc; font-weight:600; padding:10px 12px; position:sticky; top:0; background:#0f172a}
    tbody td{ padding:12px; border-top:1px solid #1f2a44 }
    tbody tr{ transition: background .15s}
    tbody tr:hover{ background:#0b1327 }
    tbody tr:first-child td{ border-top:1px solid #26314d }
    tbody tr td:first-child{ border-top-left-radius:12px }
    tbody tr td:last-child{ border-top-right-radius:12px }

    .status{display:inline-flex; gap:8px; align-items:center; font-weight:600}
    .dot{width:8px;height:8px;border-radius:999px}
    .dot.green{background:#22c55e}
    .dot.yellow{background:#facc15}
    .dot.gray{background:#64748b}

    .empty{
      display:flex; gap:16px; align-items:center; padding:16px; border:1px dashed #22304f; border-radius:14px; background:#0b1327; color:#94a3b8
    }

    .spinner{width:18px;height:18px;border-radius:999px;border:3px solid #1e293b;border-top-color:#60a5fa;animation:spin .8s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}

    .toast{position:fixed; right:18px; bottom:18px; background:#131a2b; border:1px solid #303b59; padding:12px 14px; border-radius:12px; display:none; align-items:center; gap:10px; color:#e5e7eb; box-shadow:0 10px 24px rgba(0,0,0,.35)}
    .toast.show{display:flex}
    .toast .dot{width:10px;height:10px}

    .side{display:grid; gap:36px}
    .metric{
      background:var(--card); border:1px solid #1e293b; border-radius:18px; padding:18px
    }
    .metric h3{margin:0 0 8px; font-size:.95rem; color:#cbd5e1}
    .kpi{font-weight:800; font-size:1.6rem}
    .muted{color:var(--muted)}
    .brand-logo img{ width:100%; height:100%; object-fit:contain; display:block; border-radius:12px }
  /* Centrar el recuadro de búsqueda */
  .grid > .card{ max-width:760px; width:100%; margin:0 auto }
  .side{ max-width:760px; margin:0 auto }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="brand-logo"><img src="data:image/png;base64,AQUI_TU_BASE64" alt="Importa Fácil" loading="lazy" /></div>
        <div>
          <h1>Importa Fácil · Rastreador de Envíos</h1>
          <p>Consulta el estado de tu paquete por número de tracking.</p>
          <div class="badges">
            <span class="badge">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 3l7 4v6c0 4-3 6-7 8-4-2-7-4-7-8V7l7-4z" stroke="#a5b4fc"/></svg>
              Encriptado
            </span>
            <span class="badge">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 6v6l4 2" stroke="#a5b4fc"/></svg>
              Respuesta inmediata
            </span>
            <span class="badge">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 7h18M5 11h14M7 15h10" stroke="#a5b4fc"/></svg>
              Actualizaciones claras
            </span>
          </div>
        </div>
      </div>
    </header>

    <div class="grid">
      <section class="card">
        <h2 class="title">Busca tu envío</h2>
        <form id="form" autocomplete="off">
          <div class="field">
            <svg class="left-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M11 19a8 8 0 100-16 8 8 0 000 16z" stroke="#8aa0bf" stroke-width="1.6"/><path d="M21 21l-4.3-4.3" stroke="#8aa0bf" stroke-width="1.6" stroke-linecap="round"/></svg>
            <input id="q" class="input" placeholder="Ej: IF123456, IM-998877" aria-label="Número de tracking" />
            <button class="btn" type="submit">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M3 7l9-4 9 4-9 4-9-4zM3 17l9 4 9-4M3 12l9 4 9-4" stroke="#04140a" stroke-width="1.6"/></svg>
              Buscar
            </button>
          </div>
          <div class="hstack">
            <button class="btn btn-ghost" type="button" id="demo">Probar con ejemplo</button>
            <span class="pill-hint">
              <span class="spinner" style="display:none" id="spin"></span>
              <span id="hint">Ingresa tu código exactamente como aparece en tu recibo.</span>
            </span>
          </div>
        </form>

        <div class="divider"></div>

        <div id="empty" class="empty">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="7" width="18" height="12" rx="2" stroke="#64748b"/><path d="M8 7V5a1 1 0 011-1h6a1 1 0 011 1v2" stroke="#64748b"/></svg>
          <div>
            <strong>No has realizado una búsqueda.</strong>
            <div class="muted">Cuando consultes, verás aquí el detalle de tu paquete.</div>
          </div>
        </div>

        <div id="results" class="result-wrap">
          <table role="table" aria-label="Resultados de rastreo">
            <thead>
              <tr>
                <th>Tracking</th>
                <th># de almacén</th>
                <th>Peso</th>
                <th>Estado</th>
                <th>Ubicación</th>
                <th>Fecha</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
      </section>

      <aside class="side">
        </div>
        <div class="metric">
          <h3>Estado del sistema</h3>
          <div class="hstack">
            <span class="dot green"></span>
            <span class="muted">Servicios operativos</span>
          </div>
        </div>
        </div>
      </aside>
    </div>
  </div>

  <div class="toast" id="toast">
    <span class="dot yellow"></span>
    <span id="toastText">Escribe un número de tracking válido.</span>
  </div>

  <script>
    // Datos de ejemplo solo para esta vista previa (fallback)
    const sample = [
      { tracking: 'IF123456', almacen: 'A-102', peso: '3.5 lb', estado: 'En tránsito', ubicacion: 'Miami, FL', fecha: '2025-08-12 14:31' },
      { tracking: 'IM-998877', almacen: 'M-221', peso: '12.0 lb', estado: 'En almacén', ubicacion: 'Managua, NI', fecha: '2025-08-15 09:10' },
      { tracking: 'SEA-45021', almacen: 'B-017', peso: '52.3 lb', estado: 'Despachado', ubicacion: 'Puerto Corinto, NI', fecha: '2025-08-10 18:42' }
    ];

    // URL de tu Web App (JSONP)
    const API_URL = "https://script.google.com/macros/s/AKfycbyL54IEYlM-jJJiq50QQtf3dvHIihLWQT6BPUGdf709FiH3bsW-Pz1Mgr7myvFyU4kTIQ/exec";

    const form = document.getElementById('form');
    const q = document.getElementById('q');
    const results = document.getElementById('results');
    const tbody = document.getElementById('tbody');
    const empty = document.getElementById('empty');
    const toast = document.getElementById('toast');
    const toastText = document.getElementById('toastText');
    const spin = document.getElementById('spin');
    const hint = document.getElementById('hint');

    document.getElementById('demo').addEventListener('click', () => {
      q.value = 'IF123456';
      form.dispatchEvent(new Event('submit'));
    });

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const term = (q.value || '').trim();
      if(!term){
        showToast('Escribe un número de tracking.');
        return;
      }
      spin.style.display = 'inline-block';
      hint.textContent = 'Consultando…';

      // Si estamos dentro de Apps Script, usa el backend real.
      if (isAppsScript()) {
        google.script.run
          .withSuccessHandler((rows) => {
            render(rows || []);
            spin.style.display = 'none';
            hint.textContent = 'Ingresa tu código exactamente como aparece en tu recibo.';
          })
          .withFailureHandler((err) => {
            showToast('Error al consultar: ' + (err && err.message ? err.message : err));
            spin.style.display = 'none';
            hint.textContent = 'Ingresa tu código exactamente como aparece en tu recibo.';
          })
          .buscarTracking(term);
      } else {
        // Fallback: JSONP contra tu Web App /exec (sin necesidad de google.script.run)
        const cbName = 'jsonpRender_' + Math.random().toString(36).slice(2);
        let scriptEl;
        const cleanup = () => {
          spin.style.display = 'none';
          hint.textContent = 'Ingresa tu código exactamente como aparece en tu recibo.';
          if (scriptEl && scriptEl.parentNode) scriptEl.parentNode.removeChild(scriptEl);
          try{ delete window[cbName]; }catch(_){}
        };
        window[cbName] = (api) => {
          try {
            if (api && api.ok && Array.isArray(api.results)) {
              render(api.results);
            } else {
              render([]);
            }
          } finally { cleanup(); }
        };
        const url = API_URL + '?tracking=' + encodeURIComponent(term) + '&callback=' + cbName + '&_=' + Date.now();
        scriptEl = document.createElement('script');
        scriptEl.src = url;
        scriptEl.onerror = () => { showToast('Error de conexión con la Web App.'); cleanup(); };
        document.body.appendChild(scriptEl);
      }, 680);
      }
    });

    function isAppsScript(){
      try { return !!(window.google && google.script && google.script.run); } catch { return false; }
    }

    function render(rows){
      tbody.innerHTML = '';
      if(!rows.length){
        results.classList.remove('active');
        empty.innerHTML = `
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="7" width="18" height="12" rx="2" stroke="#64748b"/><path d="M8 7V5a1 1 0 011-1h6a1 1 0 011 1v2" stroke="#64748b"/></svg>
          <div>
            <strong>No encontramos resultados para ese código.</strong>
            <div class="muted">Verifica el formato o prueba con otro.</div>
          </div>`;
        empty.style.display='flex';
        return;
      }
      empty.style.display='none';
      results.classList.add('active');
      for(const r of rows){
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><code>${esc(r.tracking)}</code></td>
          <td>${esc(r.almacen)}</td>
          <td>${esc(r.peso)}</td>
          <td>
            <span class="status">${statusDot(r.estado)} ${esc(r.estado)}</span>
          </td>
          <td>${esc(r.ubicacion)}</td>
          <td>${esc(r.fecha)}</td>`;
        tbody.appendChild(tr);
      }
    }

    function statusDot(estado){
      const map = {
        'En tránsito':'green',
        'Despachado':'yellow',
        'En almacén':'gray'
      };
      const c = map[estado] || 'gray';
      return `<span class="dot ${c}"></span>`;
    }

    function esc(s){
      return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;','\'':'&#39;'}[m]));
    }

    function showToast(msg){
      toastText.textContent = msg;
      toast.classList.add('show');
      setTimeout(()=> toast.classList.remove('show'), 2200);
    }
  </script>
</body>
</html>




